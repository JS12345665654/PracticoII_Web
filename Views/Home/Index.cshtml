@{
    ViewData["Title"] = "Inicio";

    var hora = DateTime.Now.Hour;
    var saludo = hora < 12 ? "¡Buenos días"
                : hora < 19 ? "¡Buenas tardes"
                : "¡Buenas noches";
}

<nav class="navbar navbar-expand-sm py-2 shadow-sm" id="mainNavbar">
    <div class="container-fluid d-flex justify-content-between align-items-center">
        <span class="navbar-brand fw-bold">Bug Tracker</span>

        <div class="d-flex align-items-center">
            @if (User?.Identity?.IsAuthenticated == true)
            {
                <form asp-controller="Login" asp-action="Logout" method="post" class="me-2">
                    <button type="submit" class="btn btn-outline-dark btn-sm" id="logoutButton">
                        <i class="bi bi-box-arrow-right me-1"></i> Cerrar sesión
                    </button>
                </form>
            }
            <button id="darkModeToggle" class="btn btn-outline-dark btn-sm" onclick="toggleDarkMode()">
                <i id="darkModeIcon" class="bi"></i>
            </button>
        </div>
    </div>
</nav>

<div class="container mt-5">
    <div id="carouselBienvenida" class="carousel slide mb-5 shadow rounded overflow-hidden" data-bs-ride="carousel">
        <div class="carousel-inner">
            <div class="carousel-item active">
                <img src="https://images.unsplash.com/photo-1504384308090-c894fdcc538d?auto=format&fit=crop&w=1500&q=80" class="d-block w-100" style="height: 350px; object-fit: cover;" alt="Gestión de usuarios">
                <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-3">
                    <h5>Gestión completa</h5>
                    <p>Administrá usuarios, proyectos, comentarios e incidentes desde un mismo lugar.</p>
                </div>
            </div>
            <div class="carousel-item">
                <img src="https://images.unsplash.com/photo-1556157382-97eda2d62296?auto=format&fit=crop&w=1500&q=80" class="d-block w-100" style="height: 350px; object-fit: cover;" alt="Trabajo en equipo">
                <div class="carousel-caption d-none d-md-block bg-dark bg-opacity-50 rounded p-3">
                    <h5>Trabajo en equipo</h5>
                    <p>Asigná tareas y mantené a tu equipo siempre informado.</p>
                </div>
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselBienvenida" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselBienvenida" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Siguiente</span>
        </button>
    </div>

    <div class="text-center mb-5">
        <h2 class="fw-bold">@saludo! al sistema de seguimiento de errores</h2>
        <p class="lead">
            Esta es mi primera versión del <strong>Bug Tracker</strong>. Visitá mi GitHub para más proyectos:
            <a href="https://github.com/JS12345665654" target="_blank">JS12345665654</a>
        </p>
        @if (User?.Identity?.IsAuthenticated == true && !string.IsNullOrEmpty(User.Identity.Name))
        {
            <p class="text-success">Sesión iniciada como <strong>@User.Identity.Name</strong></p>
        }
        else
        {
            <p class="text-muted">Sesión no iniciada</p>
        }
    </div>

    <div class="row text-center">
        <div class="col-md-4 mb-4">
            <div class="card border-primary shadow h-100">
                <div class="card-body">
                    <h5 class="card-title"><i class="bi bi-people-fill me-2"></i>Usuarios</h5>
                    <p class="card-text">Gestioná los usuarios registrados.</p>
                    <a class="btn btn-primary" asp-controller="Usuario" asp-action="Index">Ir</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card border-success shadow h-100">
                <div class="card-body">
                    <h5 class="card-title"><i class="bi bi-kanban-fill me-2"></i>Proyectos</h5>
                    <p class="card-text">Visualizá los proyectos activos.</p>
                    <a class="btn btn-success" asp-controller="Proyecto" asp-action="Index">Ir</a>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-4">
            <div class="card border-danger shadow h-100">
                <div class="card-body">
                    <h5 class="card-title"><i class="bi bi-bug-fill me-2"></i>Incidentes</h5>
                    <p class="card-text">Consultá o reportá errores del sistema.</p>
                    <a class="btn btn-danger" asp-controller="Incidente" asp-action="Index">Ir</a>
                </div>
            </div>
        </div>

        <div class="col-md-6 mb-4">
            <div class="card border-info shadow h-100">
                <div class="card-body">
                    <h5 class="card-title"><i class="bi bi-person-check-fill me-2"></i>Asignaciones</h5>
                    <p class="card-text">Revisá qué usuarios están asignados a tareas.</p>
                    <a class="btn btn-info text-white" asp-controller="Asignaciones" asp-action="Index">Ir</a>
                </div>
            </div>
        </div>
        <div class="col-md-6 mb-4">
            <div class="card border-warning shadow h-100">
                <div class="card-body">
                    <h5 class="card-title"><i class="bi bi-chat-left-text-fill me-2"></i>Comentarios</h5>
                    <p class="card-text">Leé y gestioná los comentarios sobre proyectos e incidentes.</p>
                    <a class="btn btn-warning text-white" asp-controller="Comentarios" asp-action="Index">Ir</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script para Modo Oscuro -->
<script>
    function toggleDarkMode() {
        const body = document.body;
        const icon = document.getElementById('darkModeIcon');
        const navbar = document.getElementById('mainNavbar');

        body.classList.toggle('dark-mode');

        if (body.classList.contains('dark-mode')) {
            icon.className = 'bi bi-moon-fill';
            navbar.classList.add('bg-dark', 'navbar-dark');
            navbar.classList.remove('bg-light', 'navbar-light');
        } else {
            icon.className = 'bi bi-sun-fill';
            navbar.classList.add('bg-light', 'navbar-light');
            navbar.classList.remove('bg-dark', 'navbar-dark');
        }

        localStorage.setItem('modoOscuro', body.classList.contains('dark-mode'));
    }

    window.addEventListener('DOMContentLoaded', () => {
        const modoOscuro = localStorage.getItem('modoOscuro') === 'true';
        const body = document.body;
        const icon = document.getElementById('darkModeIcon');
        const navbar = document.getElementById('mainNavbar');

        if (modoOscuro) {
            body.classList.add('dark-mode');
            icon.className = 'bi bi-moon-fill';
            navbar.classList.add('bg-dark', 'navbar-dark');
            navbar.classList.remove('bg-light', 'navbar-light');
        } else {
            icon.className = 'bi bi-sun-fill';
            navbar.classList.add('bg-light', 'navbar-light');
            navbar.classList.remove('bg-dark', 'navbar-dark');
        }
    });
</script>